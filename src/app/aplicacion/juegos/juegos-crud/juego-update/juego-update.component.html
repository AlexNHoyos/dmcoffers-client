<mat-card class="dialog-card">
  <mat-card-header>
    <mat-card-title>Editar Juego</mat-card-title>
  </mat-card-header>

  <mat-card-content>
    <form #juegoForm="ngForm" class="form-grid">
      <div class="row">
        <!-- Nombre del Juego -->
        <mat-form-field appearance="outline" class="col-12">
          <mat-label>Nombre</mat-label>
          <input matInput type="text" [(ngModel)]="juego.gamename" name="gamename" #name="ngModel" required />
          <mat-error *ngIf="name.invalid && (name.dirty || name.touched)">
            El nombre no puede estar vacío.
          </mat-error>
        </mat-form-field>
      </div>

      <div class="row">
        <!-- Desarrollador -->
        <mat-form-field appearance="outline" class="col-6">
          <mat-label>Desarrollador</mat-label>
          <mat-select [(ngModel)]="juego.developerName" name="developername" required>
            <mat-option *ngFor="let dev of desarrolladores" [value]="dev.developername">
              {{ dev.developername }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <!-- Publisher -->
        <mat-form-field appearance="outline" class="col-6">
          <mat-label>Publicador</mat-label>
          <mat-select [(ngModel)]="juego.publisherName" name="publishername" required>
            <mat-option *ngFor="let pub of publishers" [value]="pub.publishername">
              {{ pub.publishername }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="row">
        <!-- Categorías -->
        <mat-form-field appearance="outline" class="col-12">
          <mat-label>Categorías</mat-label>
          <mat-select [(ngModel)]="juego.categoriasNames" name="categoriasnames" multiple>
            <mat-option *ngFor="let cat of categorias" [value]="cat.description">
              {{ cat.description }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="row">
        <!-- Fecha de Salida -->
        <mat-form-field appearance="outline" class="col-6">
          <mat-label>Fecha salida</mat-label>
          <input matInput [matDatepicker]="picker1" [(ngModel)]="juego.release_date" name="release_date" required />
          <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
          <mat-datepicker #picker1></mat-datepicker>
        </mat-form-field>

        <!-- Precio -->
        <mat-form-field appearance="outline" class="col-6">
          <mat-label>Precio</mat-label>
          <input matInput type="number" [(ngModel)]="juego.price" name="price" #price="ngModel" required min="0" />
          <mat-error *ngIf="price.invalid && (price.dirty || price.touched)">
            Ingresá un precio válido.
          </mat-error>
        </mat-form-field>
      </div>

      <div class="row">
        <!-- Imagen -->
        <div class="image-upload">
          <label>Portada</label><br />
          <input type="file" (change)="onFileSelected($event)" accept="image/*" />
          <!--<img *ngIf="data.juego.image_path" [src]="environmentImg + data.juego.image_path" alt="Imagen del Juego" class="game-thumbnail" />-->
          <img [src]="juego.imageBase64 ? 'data:' + juego.imageContentType + ';base64,' + juego.imageBase64 : 'https://picsum.photos/350/120'"
              alt="Imagen del Juego" 
              class="game-thumbnail" />

        </div>
      </div>
    </form>
  </mat-card-content>

  <mat-card-actions align="end" class="action-buttons">
    <button mat-stroked-button color="warn" (click)="cancel()">Cancelar</button>

    <button mat-flat-button color="primary" (click)="onUpdateJuego()" [disabled]="juegoForm.invalid">
      Actualizar
    </button>
  </mat-card-actions>
</mat-card>